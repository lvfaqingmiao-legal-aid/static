"use strict";(self["webpackChunklegal_aid"]=self["webpackChunklegal_aid"]||[]).push([[306],{11306:function(e,o,r){r.r(o),r.d(o,{default:function(){return d}});var t=function(){var e=this,o=e._self._c;return o("div",[o("section",{staticClass:"login"},[o("div",{staticClass:"container"},[o("div",{staticClass:"row justify-content-center"},[o("div",{staticClass:"col-md-7 col-lg-5"},[o("div",{staticClass:"login-wrap p-3 p-md-5"},[o("a-form-model",{ref:"formChangePhone",attrs:{model:e.formChangePhone,rules:e.rules},on:{submit:e.changePhone},nativeOn:{submit:function(e){e.preventDefault()}}},[o("a-form-model-item",{attrs:{prop:"phone"}},[o("a-input",{attrs:{placeholder:"请输入绑定的手机号",size:"large"},model:{value:e.formChangePhone.phone,callback:function(o){e.$set(e.formChangePhone,"phone",e._n(o))},expression:"formChangePhone.phone"}},[o("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mobile"},slot:"prefix"})],1)],1),o("a-form-model-item",{attrs:{prop:"code"}},[o("a-input-search",{attrs:{placeholder:"输入验证码",size:"large"},on:{search:e.sendCode},model:{value:e.formChangePhone.code,callback:function(o){e.$set(e.formChangePhone,"code",e._n(o))},expression:"formChangePhone.code"}},[o("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"code"},slot:"prefix"}),o("a-button",{attrs:{slot:"enterButton",disabled:e.disable},slot:"enterButton"},[e._v(" "+e._s(e.btnText)+" ")])],1)],1),o("a-form-model-item",{attrs:{prop:"newPhone"}},[o("a-input",{attrs:{placeholder:"请输入新手机号",size:"large"},model:{value:e.formChangePhone.newPhone,callback:function(o){e.$set(e.formChangePhone,"newPhone",e._n(o))},expression:"formChangePhone.newPhone"}},[o("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mobile"},slot:"prefix"})],1)],1),o("a-form-model-item",{attrs:{prop:"confirmNewPhone"}},[o("a-input",{attrs:{placeholder:"请确认新手机号",size:"large"},model:{value:e.formChangePhone.confirmNewPhone,callback:function(o){e.$set(e.formChangePhone,"confirmNewPhone",e._n(o))},expression:"formChangePhone.confirmNewPhone"}},[o("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mobile"},slot:"prefix"})],1)],1),o("a-form-model-item",[o("a-button",{attrs:{type:"primary",block:"","html-type":"submit",size:"large"}},[e._v(" 提 交 ")])],1)],1)],1)])])])])])},n=[],a=(r(21703),r(84471)),s=r(81639),i=r.n(s),h={name:"changePhone",data(){let e=(e,o,r)=>{/^1[2-9]\d{9}$/.test(o)?r():r(new Error("手机号格式不正确!"))},o=(e,o,r)=>{if(!o)return r(new Error("请输入验证码！"));Number.isInteger(o)?/^\d{6}$/g.test(o)?r():r(new Error("验证码位数不正确！")):r(new Error("请输入数字！"))},r=(e,o,r)=>{""===o?r(new Error("请输入新手机号！")):/^1[2-9]\d{9}$/.test(o)?""!==this.formChangePhone.confirmNewPhone?(this.$refs.formChangePhone.validateField("confirmNewPhone"),r()):r():r(new Error("新手机号格式不正确！"))},t=(e,o,r)=>{""===o?r(new Error("请再次输入新的手机号！")):o!==this.formChangePhone.newPhone?r(new Error("两次输入的新手机号不一致!")):r()};return{formChangePhone:{phone:"",code:"",newPhone:"",confirmNewPhone:""},disable:!1,btnText:"获取验证码",isLoading:!1,rules:{phone:[{required:!0,message:"请输入手机号！",trigger:"blur"},{validator:e,trigger:"change"}],code:[{validator:o,trigger:"change"}],newPhone:[{validator:r,trigger:"change"}],confirmNewPhone:[{validator:t,trigger:"change"}]}}},methods:{changePhone(){this.$refs.formChangePhone.validate((e=>{if(!e)return void this.$message.error("请先规范填写表单！");this.isLoading=!0;const{phone:o,code:r,newPhone:t}=this.formChangePhone;if(o===t)return this.$message.error("新手机号不能和旧手机号相同！"),!1;(0,a.Z)({method:"put",url:"/ouser/changePhone",params:{oldPhone:o,code:r,newPassword:t}}).then((e=>{1===e.code?(i().clearAll(),this.$router.replace({name:"changePhoneSuccess"})):this.$message.error(e.msg)})).catch((e=>{this.$message.error("服务器错误！"),console.log(e)}))}))},sendCode(){this.$refs.formChangePhone.validateField(["phone"],(e=>{if(e)return void this.$message.error("获取验证码失败！");this.disable=!0;let o=60,r=setInterval((()=>{this.btnText=o+" 秒后重新发送",o--,o<0&&(this.disable=!1,this.btnText="获取验证码",clearInterval(r))}),1e3);(0,a.Z)({method:"get",url:"/ouser/before/getCode",params:{phone:this.formChangePhone.phone}}).then((e=>{1===e.code?this.$message.success("验证码发送成功，请注意查收！",5):this.$message.error(e.msg)})).catch((e=>{this.$message.error("服务器错误！"),console.log(e)}))}))}},activated(){this.isLoading=!1}},l=h,c=r(1001),m=(0,c.Z)(l,t,n,!1,null,"3aabdad4",null),d=m.exports}}]);
//# sourceMappingURL=306.8db8ceb4.js.map