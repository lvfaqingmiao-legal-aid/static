"use strict";(self["webpackChunklegal_aid"]=self["webpackChunklegal_aid"]||[]).push([[970],{71970:function(e,t,r){r.r(t),r.d(t,{default:function(){return p}});var s=function(){var e=this,t=e._self._c;return t("div",[t("section",{staticClass:"login"},[t("div",{staticClass:"container"},[t("div",{staticClass:"row justify-content-center"},[t("div",{staticClass:"col-md-7 col-lg-5"},[t("div",{staticClass:"login-wrap p-3 p-md-5"},[t("a-form-model",{ref:"formGetPwd",attrs:{model:e.formGetPwd,rules:e.rules},on:{submit:e.changePwd},nativeOn:{submit:function(e){e.preventDefault()}}},[e.isSuccess?t("div",[t("a-form-model-item",{attrs:{prop:"password"}},[t("a-input",{attrs:{type:"password",placeholder:"请输入新密码",size:"large"},model:{value:e.formGetPwd.password,callback:function(t){e.$set(e.formGetPwd,"password",t)},expression:"formGetPwd.password"}},[t("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),t("a-form-model-item",{attrs:{prop:"confirmPassword"}},[t("a-input",{attrs:{type:"password",placeholder:"请确认新密码",size:"large"},model:{value:e.formGetPwd.confirmPassword,callback:function(t){e.$set(e.formGetPwd,"confirmPassword",t)},expression:"formGetPwd.confirmPassword"}},[t("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),t("a-form-model-item",[t("a-button",{attrs:{type:"primary",block:"","html-type":"submit",size:"large",loading:e.isLoadingSubmit}},[e._v(" 提 交 ")])],1)],1):t("div",[t("a-form-model-item",{attrs:{prop:"phone"}},[t("a-input",{attrs:{placeholder:"请输入绑定的手机号",size:"large"},model:{value:e.formGetPwd.phone,callback:function(t){e.$set(e.formGetPwd,"phone",e._n(t))},expression:"formGetPwd.phone"}},[t("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"phone"},slot:"prefix"})],1)],1),t("a-form-model-item",{attrs:{prop:"code"}},[t("a-input-search",{attrs:{placeholder:"输入验证码",size:"large"},on:{search:e.sendCode},model:{value:e.formGetPwd.code,callback:function(t){e.$set(e.formGetPwd,"code",e._n(t))},expression:"formGetPwd.code"}},[t("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"code"},slot:"prefix"}),t("a-button",{attrs:{slot:"enterButton",disabled:e.disable},slot:"enterButton"},[e._v(" "+e._s(e.btnText)+" ")])],1)],1),t("a-form-model-item",[t("a-button",{attrs:{type:"primary",block:"",size:"large",loading:e.isLoadingNext},on:{click:e.nextStep}},[e._v(" 下 一 步 ")])],1)],1)])],1)])])])])])},o=[],a=(r(21703),r(84471)),i=r(81639),d=r.n(i),n={name:"Register",data(){let e=(e,t,r)=>{/^1[2-9]\d{9}$/.test(t)?r():r(new Error("手机号格式不正确!"))},t=(e,t,r)=>{if(!t)return r(new Error("请输入验证码！"));Number.isInteger(t)?/^\d{6}$/g.test(t)?r():r(new Error("验证码位数不正确！")):r(new Error("请输入数字！"))},r=(e,t,r)=>{""===t?r(new Error("请输入密码！")):/^(?=.*[a-zA-Z])(?=.*[0-9])[A-Za-z0-9]{8,16}$/.test(t)?""!==this.formGetPwd.confirmPassword?(this.$refs.formGetPwd.validateField("confirmPassword"),r()):r():r(new Error("新密码必须由数字和字母构成，不能全部为数字，不能全部为字母，长度在8-16位之间"))},s=(e,t,r)=>{""===t?r(new Error("请再次输入新密码！")):t!==this.formGetPwd.password?r(new Error("两次输入的密码不一致!")):r()};return{formGetPwd:{phone:"",code:"",password:"",confirmPassword:""},isSuccess:!1,disable:!1,btnText:"获取验证码",isLoadingNext:!1,isLoadingSubmit:!1,rules:{phone:[{required:!0,message:"请输入手机号！",trigger:"blur"},{validator:e,trigger:"change"}],code:[{validator:t,trigger:"change"}],password:[{validator:r,trigger:"change"}],confirmPassword:[{validator:s,trigger:"change"}]}}},methods:{changePwd(){this.$refs.formGetPwd.validateField(["password","confirmPassword"],(e=>{if(e)return void this.$message.error("请先规范填写表单！");this.isLoadingSubmit=!0;const{phone:t,password:r}=this.formGetPwd;(0,a.Z)({method:"post",url:"/ouser/changePwd",data:{phone:t,newPassword:r}}).then((e=>{1===e.code?(d().clearAll(),this.$router.replace({name:"changePwdSuccess"})):this.$message.error(e.msg),this.isLoadingSubmit=!1})).catch((e=>{this.$message.error("服务器错误！"),console.log(e)}))}))},sendCode(){this.$refs.formGetPwd.validateField(["phone"],(e=>{if(e)return void this.$message.error("获取验证码失败！");this.disable=!0;let t=60,r=setInterval((()=>{this.btnText=t+" 秒后重新发送",t--,t<0&&(this.disable=!1,this.btnText="获取验证码",clearInterval(r))}),1e3);(0,a.Z)({method:"get",url:"/ouser/before/getCode",params:{phone:this.formGetPwd.phone}}).then((e=>{1===e.code?this.$message.success("验证码发送成功，请注意查收！",5):this.$message.error(e.msg)})).catch((e=>{this.$message.error("服务器错误！"),console.log(e)}))}))},nextStep(){this.$refs.formGetPwd.validateField(["phone","code"],(e=>{if(e)return void this.$message.error("请先规范填写表单！");this.isLoadingNext=!0;const{phone:t,code:r}=this.formGetPwd;(0,a.Z)({method:"post",url:"/ouser/check",data:{phone:t,code:r}}).then((e=>{1===e.code?this.isSuccess=!0:this.$message.error(e.msg),this.isLoadingNext=!1})).catch((e=>{this.$message.error("服务器错误！"),console.log(e)}))}))}}},l=n,c=r(1001),m=(0,c.Z)(l,s,o,!1,null,"25b078c1",null),p=m.exports}}]);
//# sourceMappingURL=970.e20e5a77.js.map